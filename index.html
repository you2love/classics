<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>政治学与社会学经典著作</title>
    <style>
:root {
    --primary-color: #5c6bc0;
    --primary-dark: #3949ab;
    --primary-light: #9fa8da;
    --accent-color: #ff7043;
    --text-primary: #212121;
    --text-secondary: #757575;
    --bg-primary: #fafafa;
    --bg-secondary: #f5f5f5;
    --sidebar-width: 280px;
    --sidebar-bg: #ffffff;
    --border-color: #e0e0e0;
    --shadow-sm: 0 2px 4px rgba(0,0,0,0.1);
    --shadow-md: 0 4px 8px rgba(0,0,0,0.12);
    --shadow-lg: 0 8px 16px rgba(0,0,0,0.14);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
    background-color: var(--bg-primary);
    color: var(--text-primary);
    line-height: 1.6;
    font-size: 14px;
}

.app-container { display: flex; min-height: 100vh; }
.hidden { display: none !important; }

.sidebar {
    width: var(--sidebar-width);
    background: var(--sidebar-bg);
    border-right: 1px solid var(--border-color);
    position: fixed;
    left: 0;
    top: 0;
    height: 100vh;
    overflow-y: auto;
    z-index: 1000;
    transition: transform 0.3s ease;
    box-shadow: var(--shadow-sm);
}

.sidebar-header {
    padding: 24px 20px;
    border-bottom: 1px solid var(--border-color);
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    color: white;
    position: relative;
}

.sidebar-title {
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0;
    display: flex;
    align-items: center;
}

.sidebar-title span { margin-left: 10px; }

.btn-close-sidebar {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: white;
    font-size: 1.2rem;
    cursor: pointer;
    padding: 8px;
    display: none;
}

.main-content {
    flex: 1;
    margin-left: var(--sidebar-width);
    min-height: 100vh;
    background-color: var(--bg-primary);
}

.top-header {
    background: white;
    padding: 16px 24px;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: var(--shadow-sm);
}

#toggleSidebar {
    color: var(--text-primary);
    font-size: 1.2rem;
    padding: 8px;
    background: none;
    border: none;
    cursor: pointer;
    display: none;
}

.page-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-dark);
    margin: 0;
}

.header-actions { display: flex; align-items: center; gap: 12px; }

.book-count {
    font-size: 0.85rem;
    padding: 6px 12px;
    background: var(--text-secondary);
    color: white;
    border-radius: 4px;
}

.content-wrapper { padding: 32px 24px; max-width: 1200px; margin: 0 auto; }

.sidebar-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
}
.sidebar-overlay.active { display: block; }

.search-box { padding: 20px; position: relative; }

.search-box input {
    border-radius: 8px;
    border: 2px solid var(--border-color);
    padding: 12px 40px 12px 16px;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    width: 100%;
}

.search-box input:focus {
    border-color: var(--primary-color);
    outline: none;
}

.search-icon {
    position: absolute;
    right: 35px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 1rem;
}

.tree-nav { padding: 10px 0; }

.tree-item { cursor: pointer; transition: all 0.2s ease; }

.tree-item-content {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    color: var(--text-primary);
    transition: all 0.2s ease;
    position: relative;
}

.tree-item-content:hover { background-color: var(--bg-secondary); }

.tree-item-content.active {
    background-color: rgba(92, 107, 192, 0.1);
    color: var(--primary-color);
    border-left: 3px solid var(--primary-color);
}

.tree-toggle {
    margin-right: 8px;
    font-size: 0.8rem;
    color: var(--text-secondary);
    transition: transform 0.2s ease;
    width: 16px;
    text-align: center;
}

.tree-toggle.rotated { transform: rotate(90deg); }

.tree-icon {
    margin-right: 12px;
    color: var(--primary-color);
    font-size: 1rem;
    width: 16px;
    text-align: center;
}

.tree-text { flex: 1; font-size: 0.95rem; font-weight: 500; }

.tree-badge {
    background-color: var(--primary-light);
    color: white;
    font-size: 0.75rem;
    padding: 2px 8px;
    border-radius: 12px;
}

.tree-children { display: none; padding-left: 20px; background-color: rgba(0,0,0,0.02); }
.tree-children.expanded { display: block; }
.tree-children .tree-item-content { padding-left: 32px; }
.tree-children .tree-children .tree-item-content { padding-left: 44px; }

.welcome-section { text-align: center; padding: 60px 20px; }

.welcome-icon {
    font-size: 5rem;
    color: var(--primary-color);
    margin-bottom: 24px;
    animation: float 3s ease-in-out infinite;
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

.welcome-content h2 { font-size: 1.8rem; color: var(--primary-dark); margin-bottom: 16px; }
.welcome-content > p { font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 40px; }

.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 24px;
    margin-bottom: 40px;
}

.feature-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    background: white;
    border-radius: 12px;
    box-shadow: var(--shadow-sm);
    transition: all 0.3s ease;
}

.feature-item:hover { transform: translateY(-5px); box-shadow: var(--shadow-md); }
.feature-item i { font-size: 2rem; color: var(--primary-color); margin-bottom: 12px; }
.feature-item span { font-weight: 500; color: var(--text-primary); }

.hint-text {
    font-size: 1rem;
    color: var(--text-secondary);
    background: white;
    padding: 16px 24px;
    border-radius: 8px;
    display: inline-block;
    box-shadow: var(--shadow-sm);
}

.hint-text i { color: var(--accent-color); margin-right: 8px; }

.book-detail { animation: fadeIn 0.5s ease; }

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.book-card {
    background: white;
    border-radius: 16px;
    padding: 32px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-md);
    display: flex;
    gap: 32px;
}

.book-cover { flex-shrink: 0; width: 200px; }

.cover-placeholder {
    width: 100%;
    aspect-ratio: 2/3;
    background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 3rem;
}

.book-info { flex: 1; }

.book-title {
    font-size: 1.8rem;
    font-weight: 700;
    color: var(--primary-dark);
    margin-bottom: 16px;
    line-height: 1.3;
}

.book-meta { display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px; }

.meta-item { display: flex; align-items: center; gap: 8px; color: var(--text-secondary); font-size: 0.95rem; }
.meta-item i { color: var(--primary-color); width: 16px; }

.book-tags { display: flex; flex-wrap: wrap; gap: 8px; }

.book-tags .badge {
    font-size: 0.85rem;
    padding: 6px 12px;
    border-radius: 20px;
    background: var(--primary-color);
    color: white;
}

.book-section {
    background: white;
    border-radius: 12px;
    padding: 28px;
    margin-bottom: 24px;
    box-shadow: var(--shadow-sm);
}

.section-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-dark);
    margin-bottom: 20px;
    padding-bottom: 12px;
    border-bottom: 2px solid var(--primary-light);
}

.section-title i { margin-right: 8px; color: var(--primary-color); }

.book-description { font-size: 1.05rem; line-height: 1.8; color: var(--text-primary); text-align: justify; }

.quotes-container { display: flex; flex-direction: column; gap: 16px; }

.quote-item {
    background: var(--bg-secondary);
    padding: 20px 24px;
    border-left: 4px solid var(--primary-color);
    border-radius: 0 8px 8px 0;
    font-style: italic;
    font-size: 1.05rem;
    line-height: 1.8;
    color: var(--text-primary);
    position: relative;
}

.quote-item::before {
    content: '"';
    font-size: 3rem;
    color: var(--primary-light);
    position: absolute;
    left: 10px;
    top: -10px;
    opacity: 0.5;
}

.book-impact { font-size: 1.05rem; line-height: 1.8; color: var(--text-primary); text-align: justify; }

.sidebar::-webkit-scrollbar { width: 6px; }
.sidebar::-webkit-scrollbar-track { background: transparent; }
.sidebar::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
.sidebar::-webkit-scrollbar-thumb:hover { background: var(--text-secondary); }

.core-points-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }

.core-point-card {
    background: linear-gradient(135deg, #f8f9fa, #fff);
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-sm);
    border-left: 4px solid var(--primary-color);
    transition: all 0.3s ease;
}

.core-point-card:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); }

.point-number {
    width: 32px;
    height: 32px;
    background: var(--primary-color);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-bottom: 12px;
}

.core-point-card h4 { font-size: 1rem; color: var(--primary-dark); margin-bottom: 8px; }
.core-point-card p { font-size: 0.9rem; color: var(--text-secondary); margin: 0; line-height: 1.6; }

.table-responsive { overflow-x: auto; }

.data-table { width: 100%; border-collapse: collapse; }

.data-table th {
    background: var(--primary-color);
    color: white;
    font-weight: 500;
    padding: 12px;
    text-align: left;
}

.data-table td { padding: 12px; border-bottom: 1px solid var(--border-color); }
.data-table tr:nth-of-type(odd) { background-color: rgba(92, 107, 192, 0.05); }

.badge-warning { background: #ffc107; color: #212121; padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; }
.badge-danger { background: #dc3545; color: white; padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; }

.charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }

.chart-card { background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-sm); }
.chart-card h4 { color: var(--primary-dark); margin-bottom: 16px; font-size: 1.1rem; }
.chart-card h4 i { margin-right: 8px; color: var(--primary-color); }
.simple-chart { padding: 10px 0; }

.bar-item { margin-bottom: 12px; }
.bar-label { display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 4px; }
.bar-wrapper { background: var(--bg-secondary); border-radius: 4px; height: 28px; overflow: hidden; }

.bar {
    height: 100%;
    background: var(--primary-color);
    color: white;
    display: flex;
    align-items: center;
    padding-left: 12px;
    font-size: 0.85rem;
    font-weight: 500;
    border-radius: 4px;
    transition: width 0.5s ease;
}

.bar.accent { background: var(--accent-color); }

.timeline-container { position: relative; padding-left: 30px; }
.timeline-container::before {
    content: '';
    position: absolute;
    left: 8px;
    top: 0;
    bottom: 0;
    width: 2px;
    background: var(--primary-light);
}

.timeline-item { position: relative; padding-bottom: 24px; }
.timeline-item:last-child { padding-bottom: 0; }

.timeline-item::before {
    content: '';
    position: absolute;
    left: -26px;
    top: 4px;
    width: 12px;
    height: 12px;
    background: var(--primary-color);
    border-radius: 50%;
    border: 2px solid white;
    box-shadow: 0 0 0 2px var(--primary-color);
}

.timeline-year { font-weight: bold; color: var(--primary-color); font-size: 0.95rem; margin-bottom: 4px; }
.timeline-content h5 { color: var(--text-primary); font-size: 1rem; margin-bottom: 4px; }
.timeline-content p { color: var(--text-secondary); font-size: 0.9rem; margin: 0; }

@media (max-width: 991px) {
    .sidebar { transform: translateX(-100%); }
    .sidebar.active { transform: translateX(0); }
    .main-content { margin-left: 0; }
    .btn-close-sidebar { display: block; }
    #toggleSidebar { display: block; }
    .book-card { flex-direction: column; align-items: center; text-align: center; }
    .book-cover { width: 150px; }
    .book-meta { justify-content: center; }
    .book-tags { justify-content: center; }
    .page-title { font-size: 1.2rem; }
}

@media (max-width: 576px) {
    .welcome-content h2 { font-size: 1.5rem; }
    .book-title { font-size: 1.5rem; }
    .section-title { font-size: 1.2rem; }
    .content-wrapper { padding: 20px 16px; }
    .book-card, .book-section { padding: 20px; }
}
    </style>
</head>
<body>
    <div class="app-container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 class="sidebar-title">
                    <span>&#x1F4DA;</span>
                    <span>经典著作</span>
                </h3>
                <button class="btn-close-sidebar" id="closeSidebar">&#x2715;</button>
            </div>
            
            <div class="search-box">
                <input type="text" class="form-control" id="searchInput" placeholder="搜索...">
                <span class="search-icon">&#x1F50D;</span>
            </div>
            
            <nav class="tree-nav" id="treeNav"></nav>
        </aside>

        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <main class="main-content">
            <header class="top-header">
                <button class="btn" id="toggleSidebar">&#x2630;</button>
                <h1 class="page-title">政治学与社会学经典著作</h1>
                <div class="header-actions">
                    <span class="book-count">
                        <span>&#x1F4CA;</span>
                        <span id="bookCount">0</span> 本经济著作
                    </span>
                </div>
            </header>

            <div class="content-wrapper">
                <div id="welcomeSection" class="welcome-section">
                    <div class="welcome-content">
                        <div class="welcome-icon">&#x1F4DA;</div>
                        <h2>政治学与社会学经典著作</h2>
                        <p>理解中国政府运作与社会治理</p>
                        <div class="features-grid">
                            <div class="feature-item">
                                <span style="font-size:2rem">&#x1F3E2;</span>
                                <span>政府治理</span>
                            </div>
                            <div class="feature-item">
                                <span style="font-size:2rem">&#x1F465;</span>
                                <span>社会分析</span>
                            </div>
                            <div class="feature-item">
                                <span style="font-size:2rem">&#x1F4CA;</span>
                                <span>公共政策</span>
                            </div>
                            <div class="feature-item">
                                <span style="font-size:2rem">&#x1F3E0;</span>
                                <span>基层治理</span>
                            </div>
                        </div>
                        <p class="hint-text">
                            <span>&#x1F449;</span>
                            点击左侧选择一本著作开始阅读
                        </p>
                    </div>
                </div>

                <div id="bookDetail" class="book-detail hidden">
                    <div class="book-card">
                        <div class="book-cover">
                            <div class="cover-placeholder">&#x1F4CA;</div>
                        </div>
                        <div class="book-info">
                            <h2 class="book-title" id="bookTitle">书名</h2>
                            <div class="book-meta">
                                <span class="meta-item">
                                    <span>&#x270D;&#xFE0F;</span>
                                    <span id="bookAuthor">作者</span>
                                </span>
                                <span class="meta-item">
                                    <span>&#x1F4C5;</span>
                                    <span id="bookYear">年代</span>
                                </span>
                                <span class="meta-item">
                                    <span>&#x1F310;</span>
                                    <span id="bookCountry">国家</span>
                                </span>
                            </div>
                            <div class="book-tags" id="bookTags"></div>
                        </div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x2139;&#xFE0F;</span>
                            作品简介
                        </h3>
                        <p class="book-description" id="bookDescription"></p>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F4A1;</span>
                            核心要点
                        </h3>
                        <div id="corePointsChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F4CB;</span>
                            章节结构
                        </h3>
                        <div class="table-responsive">
                            <table class="data-table" id="chapterTable">
                                <thead><tr><th>章节</th><th>内容</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F5E3;</span>
                            中国政府层级划分
                        </h3>
                        <div id="governmentStructureChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F4B0;</span>
                            中央与地方财权事权分配
                        </h3>
                        <div id="fiscalDistributionChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F3AF;</span>
                            地方政府发展逻辑
                        </h3>
                        <div id="developmentLogicChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F451;</span>
                            官员考核与激励机制
                        </h3>
                        <div id="officialEvaluationChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F4CA;</span>
                            关键数据
                        </h3>
                        <div id="dataCharts" class="charts-grid"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1F551;</span>
                            财政体制改革历程
                        </h3>
                        <div class="timeline" id="timelineChart"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x1FA99;</span>
                            土地财政
                        </h3>
                        <div class="table-responsive">
                            <table class="data-table" id="landFinanceTable">
                                <thead><tr><th>来源</th><th>描述</th><th>规模/占比</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x26A0;&#xFE0F;</span>
                            债务风险
                        </h3>
                        <div class="table-responsive">
                            <table class="data-table" id="debtTable">
                                <thead><tr><th>类型</th><th>规模/措施</th></tr></thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x275D;</span>
                            经典摘录
                        </h3>
                        <div class="quotes-container" id="bookQuotes"></div>
                    </div>

                    <div class="book-section">
                        <h3 class="section-title">
                            <span>&#x2B50;</span>
                            影响与评价
                        </h3>
                        <p class="book-impact" id="bookImpact"></p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
var booksData = {
  "categories": [
    {
      "id": "economics",
      "name": "经济政治",
      "children": [
        {
          "id": "china-development",
          "name": "置身事内：中国政府与经济发展",
          "author": "兰小欢",
          "year": "2021",
          "country": "中国",
          "description": "复旦大学经济学院副教授兰小欢多年教学与研究内容的凝练，将经济学原理与中国经济发展的实践有机融合，以地方政府投融资为主线，深入浅出地论述了中国经济的发展。",
          "impact": "帮助读者理解中国政治经济体系的运作方式，指出中国政府通过深度介入工业化和城市化的进程，在发展经济的同时逐步推动了市场机制的建立和完善。",
          "tags": ["经济学", "政府治理", "中国发展"],
          "quotes": [
            "在我国，政府不但影响'蛋糕'的分配，也参与'蛋糕'的生产，所以我们不可能脱离政府谈经济。",
            "社会进程本是整体，密不可分。所谓经济，不过是研究者从这洪流中人工提炼出的部分事实。",
            "要想真正认识复杂的经济现象，必须极力避免政府和市场的二分法。"
          ],
          "structure": {
            "chapters": [
              {"name": "上篇：微观机制", "content": "地方政府的基本事务、收支、土地融资和开发、投资和债务"},
              {"name": "下篇：宏观现象", "content": "城市化、工业化、房价、地区差异、债务风险、国内经济结构失衡、国际贸易冲突"},
              {"name": "总结", "content": "提炼和全书内容要点"}
            ]
          },
          "corePoints": [
            {"title": "政府与市场关系", "content": "不能脱离政府谈经济，政府深度参与蛋糕生产与分配"},
            {"title": "分税制改革", "content": "1994年分税制导致土地财政和土地金融诞生"},
            {"title": "土地金融", "content": "地方政府通过土地抵押融资推动城市化工业化"},
            {"title": "政府投资模式", "content": "政府主导投资带动经济发展，形成地方债务"},
            {"title": "城市化特点", "content": "重土地、轻人，推高房价，加重居民债务"},
            {"title": "工业化特点", "content": "重规模、重扩张，加速企业成长，加重债务风险"},
            {"title": "供给侧改革", "content": "去杠杆、防风险，推进市场化改革"},
            {"title": "双循环战略", "content": "扩大内需，对外开放，应对国际贸易冲突"}
          ],
          "governmentStructure": {
            "levels": [
              {"level": "中央", "role": "重大决策、统一领导", "count": "1"},
              {"level": "省", "role": "区域统筹、政策执行", "count": "34"},
              {"level": "市", "role": "城市管理、承上启下", "count": "333"},
              {"level": "县区", "role": "县域治理、公共服务", "count": "2844"},
              {"level": "乡镇", "role": "基层治理、具体执行", "count": "38736"}
            ],
            "principles": [
              {"name": "外部性原则", "content": "由影响范围最大的层级负责"},
              {"name": "信息复杂性原则", "content": "信息复杂的事项由信息优势方负责"},
              {"name": "激励相容原则", "content": "让各方的利益与目标一致"}
            ]
          },
          "fiscalDistribution": {
            "taxDistribution": [
              {"tax": "增值税", "central": "50%", "local": "50%"},
              {"tax": "消费税", "central": "100%", "local": "0%"},
              {"tax": "企业所得税", "central": "60%", "local": "40%"},
              {"tax": "个人所得税", "central": "60%", "local": "40%"},
              {"tax": "土地出让金", "central": "0%", "local": "100%"}
            ],
            "mismatch": "事权下放但财权上收，导致地方财政缺口"
          },
          "developmentLogic": {
            "landFinance": [
              {"step": "1. 低价征地", "description": "从农村征收集体土地转为国有"},
              {"step": "2. 土地平整", "description": "进行基础设施建设"},
              {"step": "3. 高价出让", "description": "出让土地使用权给开发商"},
              {"step": "4. 循环投入", "description": "用出让金继续投资建设"}
            ],
            "characteristics": [
              {"name": "重土地", "description": "重视土地开发和城市建设"},
              {"name": "轻人", "description": "相对忽视人口市民化和公共服务"},
              {"name": "重投资", "description": "依靠政府投资拉动增长"},
              {"name": "重规模", "description": "追求GDP规模和增速"}
            ]
          },
          "officialEvaluation": {
            "kpi": [
              {"metric": "GDP增长率", "weight": "高", "period": "任期 内"},
              {"metric": "招商引资", "weight": "高", "period": "年度考核"},
              {"metric": "财政收入", "weight": "中", "period": "年度考核"},
              {"metric": "社会稳定", "weight": "中", "period": "任期考核"},
              {"metric": "环境保护", "weight": "上升中", "period": "近年强化"}
            ],
            "promotion": [
              {"system": "锦标赛制", "description": "官员晋升取决于相对GDP排名"},
              {"feature": "纵向竞争", "description": "下级政府的表现影响上级考核"},
              {"feature": "横向竞争", "description": "同级政府间GDP竞赛"},
              {"issue": "问题", "description": "可能导致过度投资、资源浪费"}
            ]
          },
          "data": {
            "fiscalSystem": [
              {"year": "1994", "event": "分税制改革", "impact": "中央财政占比提升，地方收入减少"},
              {"year": "1998", "event": "住房制度改革", "impact": "房地产市场化启动"},
              {"year": "2001", "event": "加入WTO", "impact": "出口驱动型经济增长"},
              {"year": "2008", "event": "四万亿刺激", "impact": "政府投资大幅扩张"},
              {"year": "2015", "event": "供给侧结构性改革", "content": "去杠杆、去产能、去库存"},
              {"year": "2020", "event": "双循环战略", "content": "扩大内需为主，内外需结合"}
            ],
            "landFinance": [
              {"source": "土地使用权出让", "description": "土地出让金是地方政府重要收入", "ratio": "约30-50%"},
              {"source": "土地抵押融资", "description": "通过土地抵押获取银行贷款", "scale": "数十万亿"},
              {"source": "城投债", "description": "地方政府融资平台发行债券", "scale": "持续增长"}
            ],
            "urbanization": [
              {"metric": "2000年城镇化率", "value": "36%"},
              {"metric": "2020年城镇化率", "value": "63.9%"},
              {"metric": "年均提升", "value": "约1.4个百分点"}
            ],
            "debtRisk": [
              {"type": "地方政府显性债务", "scale": "约30万亿"},
              {"type": "地方政府隐性债务", "scale": "估计40-50万亿"},
              {"type": "债务风险防范", "measure": "严控新增债务，化解存量风险"}
            ]
          },
          {
            "id": "class-analysis",
            "name": "中国社会各阶级的分析",
            "author": "毛泽东",
            "year": "1925",
            "country": "中国",
            "description": "毛泽东于1925年撰写的重要文章，是毛泽东思想的奠基之作。文章开篇即提出'谁是我们的敌人？谁是我们的朋友？'这一革命的首要问题，通过对中国社会各阶级的经济地位和政治态度的分析，确定了革命的对象、动力和领导力量。",
            "impact": "为中国革命指明了方向，是中国共产党在大革命时期的指导思想，影响了整个中国近现代史的进程。",
            "tags": ["政治", "阶级分析", "革命"],
            "quotes": [
              "谁是我们的敌人？谁是我们的朋友？这是革命的首要问题。",
              "中国过去一切革命斗争成效甚少，其基本原因就是因为不能团结真正的朋友，以攻击真正的敌人。",
              "革命党是群众的向导，在革命中未有革命党领错了路而革命不失败的。"
            ],
            "corePoints": [
              {"title": "阶级划分标准", "content": "以经济地位为基础划分地主阶级、买办阶级、中产阶级、小资产阶级、半无产阶级、无产阶级"},
              {"title": "敌人", "content": "地主阶级和买办阶级是帝国主义走狗，是革命的对象"},
              {"title": "朋友", "content": "工人、农民、小资产阶级和民族资产阶级左翼是革命的朋友"},
              {"title": "领导力量", "content": "无产阶级是革命的领导力量"}
            ],
            "classAnalysis": {
              "classes": [
                {"class": "地主阶级&买办阶级", "status": "反革命", "reason": "依附帝国主义，维护旧秩序"},
                {"class": "中产阶级", "status": "动摇", "reason": "既有革命要求又有妥协性"},
                {"class": "小资产阶级", "status": "革命同盟军", "reason": "自给自足但具有动摇性"},
                {"class": "半无产阶级", "status": "革命主力军", "reason": "生活困苦，反抗意识强"},
                {"class": "无产阶级", "status": "领导阶级", "reason": "最具组织性和革命彻底性"}
              ]
            }
          },
          {
            "id": "government-politics",
            "name": "中国政府与政治",
            "author": "景跃进等",
            "year": "2020",
            "country": "中国",
            "description": "由清华大学、复旦大学等高校学者联合编写的政治学教材，系统阐述当代中国政府与政治的组织原理、基本结构、运行机制及历史发展。",
            "impact": "是国内政治学领域的重要教材，帮助学生理解中国政治制度和治理体系。",
            "tags": ["政治学", "教材", "制度"],
            "quotes": [
              "中国共产党领导是中国特色社会主义最本质的特征。",
              "人民代表大会制度是我国的根本政治制度。"
            ],
            "corePoints": [
              {"title": "党政体制", "content": "理解中国政府与政治的核心在于把握党政体制"},
              {"title": "横向结构", "content": "人大、政协、政府、法院、检察院等"},
              {"title": "纵向关系", "content": "中央与地方关系、民族区域自治、基层治理"},
              {"title": "国家与社会", "content": "群众与公民视角下的国家社会关系变迁"}
            ]
          },
          {
            "id": "public-policy",
            "name": "公共政策分析",
            "author": "陈庆云",
            "year": "2011",
            "country": "中国",
            "description": "北京大学陈庆云教授编写的公共管理专业教材，系统阐述公共政策分析的基本概念、原理及模型分析方法。",
            "impact": "被多所高校选定为公共管理学考研考博参考书目，是国内公共政策领域的经典教材。",
            "tags": ["公共管理", "政策分析", "教材"],
            "quotes": [
              "公共政策是政府对社会公共事务的管理手段。"
            ],
            "corePoints": [
              {"title": "政策系统", "content": "政策主体、客体、环境、工具"},
              {"title": "政策过程", "content": "问题界定、方案制定、执行、评估、终结"},
              {"title": "政策分析", "content": "事实分析、价值分析、规范分析、可行性分析"}
            ]
          },
          {
            "id": "governing-china",
            "name": "治理中国：从革命到改革",
            "author": "李侃如",
            "year": "2010",
            "country": "美国",
            "description": "美国著名中国问题专家李侃如的代表作，从美国学者的视角系统分析中国社会变革、政府管理体系和经济发展，是继费正清《美国与中国》之后的又一部重要学术著作。",
            "impact": "反映了西方中国学研究的水平，是目前美国使用最广泛的介绍中国政治的教科书。",
            "tags": ["政治学", "中国研究", "外国学者"],
            "quotes": [
              "治理是一个集理念、过程和目标三者并重的概念。"
            ],
            "corePoints": [
              {"title": "历史遗产", "content": "中华帝国的遗产与式微、儒家思想、清朝衰落"},
              {"title": "革命道路", "content": "毛泽东思想、文化大革命、改革开放"},
              {"title": "政府机构", "content": "中央政府、县、乡等层级管理体系"},
              {"title": "当代挑战", "content": "经济发展与环境保护的平衡"}
            ]
          },
          {
            "id": "sociology-intro",
            "name": "社会学概论新修",
            "author": "郑杭生",
            "year": "2019",
            "country": "中国",
            "description": "中国人民大学郑杭生教授主编的社会学入门教材，贯彻社会学中国化的学术取向，以社会运行论为理论主线，是国内社会学领域最权威的教材之一。",
            "impact": "获首届全国教材建设奖全国优秀教材一等奖，是国内社会学课程的经典教材。",
            "tags": ["社会学", "教材", "理论"],
            "quotes": [
              "社会学是关于社会良性运行和协调发展的条件和机制的综合性具体社会科学。"
            ],
            "corePoints": [
              {"title": "社会运行论", "content": "社会良性运行和协调发展的条件与机制"},
              {"title": "社会转型论", "content": "从传统社会向现代社会转型的过程"},
              {"title": "社会化", "content": "从生物人向社会人的转变过程"},
              {"title": "社会群体与组织", "content": "群体类型、组织结构与运行机制"},
              {"title": "社会制度与分层", "content": "制度功能、社会分层与社会流动"}
            ]
          },
          {
            "id": "rural-governance",
            "name": "乡镇治理与政府制度化",
            "author": "赵树凯",
            "year": "2018",
            "country": "中国",
            "description": "国务院发展研究中心赵树凯基于20个乡镇的实地调研，分析基层政府的低制度化问题，是研究中国乡镇治理的经典著作。",
            "impact": "开创了中国政府研究的新路径，是理解中国基层治理的重要学术作品。",
            "tags": ["基层治理", "政府改革", "农村研究"],
            "quotes": [
              "基层政府的制度环境没有改变，基层政府的行为逻辑也没有改变。"
            ],
            "corePoints": [
              {"title": "财政困局", "content": "乡镇财政赤字与债务危机"},
              {"title": "权力格局", "content": "上下级之间的权力关系与问责体系"},
              {"title": "公共服务", "content": "乡镇政府公共服务供给与冲突控制"},
              {"title": "制度化路径", "content": "从人治向法治转型的方向"}
            ]
          },
          {
            "id": "big-country-big-city",
            "name": "大国大城：当代中国的统一、发展与平衡",
            "author": "陆铭",
            "year": "2016",
            "country": "中国",
            "description": "上海交通大学陆铭教授聚焦中国城市化进程中的城乡经济结构性矛盾，主张发展大城市是解决城市病的根本之道，获第十二届文津图书奖。",
            "impact": "为理解中国城市化路径提供了重要视角，对政策制定产生了积极影响。",
            "tags": ["经济学", "城市化", "区域发展"],
            "quotes": [
              "只有聚集中经济发展才能走向均衡。",
              "限制户籍解决不了城市病，让农民工返乡治愈不了乡村隐痛。"
            ],
            "corePoints": [
              {"title": "三个D", "content": "密度(Density)、距离(Distance)、分割(Division)"},
              {"title": "空间误解", "content": "纠正关于城市规模的不正确认识"},
              {"title": "自由移民", "content": "实现地区间人均GDP均衡的唯一可行路径"},
              {"title": "人均GDP均衡", "content": "以人均GDP均衡替代区域GDP总量均衡"}
            ]
          }
        ]
      }
    ]
  ]
};
var allBooks = [];

document.addEventListener('DOMContentLoaded', function() {
    loadBooksData();
    initializeEventListeners();
});

function loadBooksData() {
    allBooks = collectAllBooks(booksData.categories);
    updateBookCount();
    renderTreeNav(booksData.categories);
}

function collectAllBooks(categories) {
    var books = [];
    
    function traverse(items) {
        items.forEach(function(item) {
            if (item.author && item.description) {
                books.push(item);
            }
            if (item.children) {
                traverse(item.children);
            }
        });
    }
    
    traverse(categories);
    return books;
}

function updateBookCount() {
    document.getElementById('bookCount').textContent = allBooks.length;
}

function renderTreeNav(categories, parentElement, level) {
    if (!parentElement) {
        parentElement = document.getElementById('treeNav');
        parentElement.innerHTML = '';
    }
    
    categories.forEach(function(item) {
        var isBook = item.author && item.description;
        var hasChildren = item.children && item.children.length > 0;
        
        var treeItem = document.createElement('div');
        treeItem.className = 'tree-item';
        treeItem.dataset.id = item.id;
        treeItem.dataset.name = item.name.toLowerCase();
        
        var itemContent = document.createElement('div');
        itemContent.className = 'tree-item-content';
        
        if (hasChildren) {
            var toggleIcon = document.createElement('span');
            toggleIcon.className = 'tree-toggle';
            toggleIcon.textContent = '>';
            itemContent.appendChild(toggleIcon);
        } else {
            var spacer = document.createElement('span');
            spacer.style.width = '16px';
            spacer.style.display = 'inline-block';
            itemContent.appendChild(spacer);
        }
        
        var icon = document.createElement('span');
        icon.className = 'tree-icon';
        icon.textContent = isBook ? '&#x1F4D6;' : '&#x1F4C1;';
        itemContent.appendChild(icon);
        
        var text = document.createElement('span');
        text.className = 'tree-text';
        text.textContent = item.name;
        itemContent.appendChild(text);
        
        if (isBook && item.tags) {
            var badge = document.createElement('span');
            badge.className = 'badge tree-badge';
            badge.textContent = item.tags[0] || '经典';
            itemContent.appendChild(badge);
        }
        
        treeItem.appendChild(itemContent);
        parentElement.appendChild(treeItem);
        
        if (hasChildren) {
            var childrenContainer = document.createElement('div');
            childrenContainer.className = 'tree-children';
            renderTreeNav(item.children, childrenContainer, level + 1);
            treeItem.appendChild(childrenContainer);
            
            itemContent.addEventListener('click', function(e) {
                e.stopPropagation();
                var toggleIcon = this.querySelector('.tree-toggle');
                toggleIcon.classList.toggle('rotated');
                childrenContainer.classList.toggle('expanded');
            });
        }
        
        if (isBook) {
            itemContent.addEventListener('click', function(e) {
                e.stopPropagation();
                showBookDetail(item);
                
                document.querySelectorAll('.tree-item-content').forEach(function(el) {
                    el.classList.remove('active');
                });
                this.classList.add('active');
                
                if (window.innerWidth < 992) {
                    closeSidebar();
                }
            });
        }
    });
}

function showBookDetail(book) {
    document.getElementById('welcomeSection').classList.add('hidden');
    document.getElementById('bookDetail').classList.remove('hidden');
    
    document.getElementById('bookTitle').textContent = book.name;
    document.getElementById('bookAuthor').textContent = book.author;
    document.getElementById('bookYear').textContent = book.year;
    document.getElementById('bookCountry').textContent = book.country;
    document.getElementById('bookDescription').textContent = book.description;
    document.getElementById('bookImpact').textContent = book.impact;
    
    var tagsContainer = document.getElementById('bookTags');
    tagsContainer.innerHTML = '';
    if (book.tags) {
        book.tags.forEach(function(tag) {
            var badge = document.createElement('span');
            badge.className = 'badge';
            badge.textContent = tag;
            tagsContainer.appendChild(badge);
        });
    }
    
    var quotesContainer = document.getElementById('bookQuotes');
    quotesContainer.innerHTML = '';
    if (book.quotes) {
        book.quotes.forEach(function(quote) {
            var quoteItem = document.createElement('div');
            quoteItem.className = 'quote-item';
            quoteItem.textContent = quote;
            quotesContainer.appendChild(quoteItem);
        });
    }
    
    renderCharts(book);
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function renderCharts(book) {
    renderCorePoints(book.corePoints);
    renderChapterTable(book.structure);
    
    if (book.governmentStructure) {
        document.getElementById('governmentStructureChart').parentElement.style.display = 'block';
        renderGovernmentStructure(book.governmentStructure);
    } else {
        document.getElementById('governmentStructureChart').parentElement.style.display = 'none';
    }
    
    if (book.fiscalDistribution) {
        document.getElementById('fiscalDistributionChart').parentElement.style.display = 'block';
        renderFiscalDistribution(book.fiscalDistribution);
    } else {
        document.getElementById('fiscalDistributionChart').parentElement.style.display = 'none';
    }
    
    if (book.developmentLogic) {
        document.getElementById('developmentLogicChart').parentElement.style.display = 'block';
        renderDevelopmentLogic(book.developmentLogic);
    } else {
        document.getElementById('developmentLogicChart').parentElement.style.display = 'none';
    }
    
    if (book.officialEvaluation) {
        document.getElementById('officialEvaluationChart').parentElement.style.display = 'block';
        renderOfficialEvaluation(book.officialEvaluation);
    } else {
        document.getElementById('officialEvaluationChart').parentElement.style.display = 'none';
    }
    
    if (book.data && book.data.urbanization) {
        document.getElementById('dataCharts').parentElement.style.display = 'block';
        renderDataCharts(book.data);
    } else {
        document.getElementById('dataCharts').parentElement.style.display = 'none';
    }
    
    if (book.data && book.data.fiscalSystem) {
        document.getElementById('timelineChart').parentElement.style.display = 'block';
        renderTimeline(book.data.fiscalSystem);
    } else {
        document.getElementById('timelineChart').parentElement.style.display = 'none';
    }
    
    if (book.data && book.data.landFinance) {
        document.getElementById('landFinanceTable').parentElement.style.display = 'block';
        renderLandFinanceTable(book.data.landFinance);
    } else {
        document.getElementById('landFinanceTable').parentElement.style.display = 'none';
    }
    
    if (book.data && book.data.debtRisk) {
        document.getElementById('debtTable').parentElement.style.display = 'block';
        renderDebtTable(book.data.debtRisk);
    } else {
        document.getElementById('debtTable').parentElement.style.display = 'none';
    }
}

function renderCorePoints(corePoints) {
    var container = document.getElementById('corePointsChart');
    if (!corePoints) {
        container.innerHTML = '';
        return;
    }
    
    var grid = document.createElement('div');
    grid.className = 'core-points-grid';
    
    corePoints.forEach(function(point, index) {
        var card = document.createElement('div');
        card.className = 'core-point-card';
        card.innerHTML = '<div class="point-number">' + (index + 1) + '</div><h4>' + point.title + '</h4><p>' + point.content + '</p>';
        grid.appendChild(card);
    });
    
    container.innerHTML = '';
    container.appendChild(grid);
}

function renderChapterTable(structure) {
    var tbody = document.querySelector('#chapterTable tbody');
    if (!structure || !structure.chapters) {
        tbody.innerHTML = '';
        return;
    }
    
    tbody.innerHTML = structure.chapters.map(function(ch) {
        return '<tr><td><strong>' + ch.name + '</strong></td><td>' + ch.content + '</td></tr>';
    }).join('');
}

function renderGovernmentStructure(gs) {
    var container = document.getElementById('governmentStructureChart');
    if (!gs || !gs.levels) {
        container.innerHTML = '';
        return;
    }
    
    var html = '<div class="table-responsive"><table class="data-table"><thead><tr><th>层级</th><th>数量</th><th>主要职能</th></tr></thead><tbody>';
    gs.levels.forEach(function(l) {
        html += '<tr><td><strong>' + l.level + '</strong></td><td>' + l.count + '</td><td>' + l.role + '</td></tr>';
    });
    html += '</tbody></table></div>';
    
    html += '<h4 style="margin:20px 0 10px">事权划分三原则</h4><div class="core-points-grid">';
    gs.principles.forEach(function(p, i) {
        html += '<div class="core-point-card"><div class="point-number">' + (i+1) + '</div><h4>' + p.name + '</h4><p>' + p.content + '</p></div>';
    });
    html += '</div>';
    
    container.innerHTML = html;
}

function renderFiscalDistribution(fd) {
    var container = document.getElementById('fiscalDistributionChart');
    if (!fd || !fd.taxDistribution) {
        container.innerHTML = '';
        return;
    }
    
    var html = '<div class="table-responsive"><table class="data-table"><thead><tr><th>税种</th><th>中央</th><th>地方</th></tr></thead><tbody>';
    fd.taxDistribution.forEach(function(t) {
        html += '<tr><td><strong>' + t.tax + '</strong></td><td>' + t.central + '</td><td>' + t.local + '</td></tr>';
    });
    html += '</tbody></table></div>';
    html += '<p style="margin-top:15px;color:var(--text-secondary);"><strong>核心问题：</strong>' + fd.mismatch + '</p>';
    
    container.innerHTML = html;
}

function renderDevelopmentLogic(dl) {
    var container = document.getElementById('developmentLogicChart');
    if (!dl || !dl.landFinance) {
        container.innerHTML = '';
        return;
    }
    
    var html = '<h4>土地财政四步曲</h4><div class="core-points-grid">';
    dl.landFinance.forEach(function(l, i) {
        html += '<div class="core-point-card"><div class="point-number">' + l.step + '</div><h4>' + l.description + '</h4></div>';
    });
    html += '</div>';
    
    html += '<h4 style="margin:20px 0 10px">发展模式特点</h4><div class="core-points-grid">';
    dl.characteristics.forEach(function(c) {
        html += '<div class="core-point-card" style="border-left-color:var(--accent-color)"><h4>' + c.name + '</h4><p>' + c.description + '</p></div>';
    });
    html += '</div>';
    
    container.innerHTML = html;
}

function renderOfficialEvaluation(oe) {
    var container = document.getElementById('officialEvaluationChart');
    if (!oe || !oe.kpi) {
        container.innerHTML = '';
        return;
    }
    
    var html = '<div class="table-responsive"><table class="data-table"><thead><tr><th>考核指标</th><th>权重</th><th>考核周期</th></tr></thead><tbody>';
    oe.kpi.forEach(function(k) {
        html += '<tr><td><strong>' + k.metric + '</strong></td><td>' + k.weight + '</td><td>' + k.period + '</td></tr>';
    });
    html += '</tbody></table></div>';
    
    html += '<h4 style="margin:20px 0 10px">晋升机制</h4><div class="core-points-grid">';
    if (oe.promotion) {
        html += '<div class="core-point-card"><div class="point-number">制</div><h4>' + oe.promotion.system + '</h4><p>' + oe.promotion.description + '</p></div>';
        oe.promotion.feature.split('；').forEach(function(f, i) {
            html += '<div class="core-point-card"><div class="point-number">' + (i+1) + '</div><p>' + f + '</p></div>';
        });
        if (oe.promotion.issue) {
            html += '<div class="core-point-card" style="border-left-color:#dc3545"><div class="point-number" style="background:#dc3545">!</div><p><strong>' + oe.promotion.issue + '：</strong>' + oe.promotion.description + '</p></div>';
        }
    }
    html += '</div>';
    
    container.innerHTML = html;
}

function renderDataCharts(data) {
    var container = document.getElementById('dataCharts');
    if (!data || !data.urbanization) {
        container.innerHTML = '';
        return;
    }
    
    var html = '<div class="chart-card"><h4><span>&#x1F3E0;</span> 城镇化率变化</h4><div class="simple-chart">';
    
    if (data.urbanization[0]) {
        html += '<div class="bar-item"><span class="bar-label">' + data.urbanization[0].metric + '</span><div class="bar-wrapper"><div class="bar" style="width: ' + parseInt(data.urbanization[0].value) + '%">' + data.urbanization[0].value + '</div></div></div>';
    }
    if (data.urbanization[1]) {
        html += '<div class="bar-item"><span class="bar-label">' + data.urbanization[1].metric + '</span><div class="bar-wrapper"><div class="bar" style="width: ' + parseInt(data.urbanization[1].value) + '%">' + data.urbanization[1].value + '</div></div></div>';
    }
    if (data.urbanization[2]) {
        html += '<div class="bar-item"><span class="bar-label">' + data.urbanization[2].metric + '</span><div class="bar-wrapper"><div class="bar accent" style="width: 30%">' + data.urbanization[2].value + '</div></div></div>';
    }
    
    html += '</div></div>';
    container.innerHTML = html;
}

function renderTimeline(fiscalSystem) {
    var container = document.getElementById('timelineChart');
    if (!fiscalSystem) {
        container.innerHTML = '';
        return;
    }
    
    var timeline = document.createElement('div');
    timeline.className = 'timeline-container';
    
    fiscalSystem.forEach(function(item) {
        var itemEl = document.createElement('div');
        itemEl.className = 'timeline-item';
        itemEl.innerHTML = '<div class="timeline-year">' + item.year + '</div><div class="timeline-content"><h5>' + item.event + '</h5><p>' + (item.impact || item.content) + '</p></div>';
        timeline.appendChild(itemEl);
    });
    
    container.innerHTML = '';
    container.appendChild(timeline);
}

function renderLandFinanceTable(landFinance) {
    var tbody = document.querySelector('#landFinanceTable tbody');
    if (!landFinance) {
        tbody.innerHTML = '';
        return;
    }
    
    tbody.innerHTML = landFinance.map(function(item) {
        return '<tr><td><strong>' + item.source + '</strong></td><td>' + item.description + '</td><td><span class="badge-warning">' + (item.ratio || item.scale) + '</span></td></tr>';
    }).join('');
}

function renderDebtTable(debtRisk) {
    var tbody = document.querySelector('#debtTable tbody');
    if (!debtRisk) {
        tbody.innerHTML = '';
        return;
    }
    
    tbody.innerHTML = debtRisk.map(function(item) {
        return '<tr><td><strong>' + item.type + '</strong></td><td><span class="badge-danger">' + (item.scale || item.measure) + '</span></td></tr>';
    }).join('');
}

function initializeEventListeners() {
    document.getElementById('toggleSidebar').addEventListener('click', openSidebar);
    document.getElementById('closeSidebar').addEventListener('click', closeSidebar);
    document.getElementById('sidebarOverlay').addEventListener('click', closeSidebar);
    
    document.getElementById('searchInput').addEventListener('input', handleSearch);
    
    window.addEventListener('resize', function() {
        if (window.innerWidth >= 992) {
            document.getElementById('sidebarOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }
    });
}

function openSidebar() {
    document.getElementById('sidebar').classList.add('active');
    document.getElementById('sidebarOverlay').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeSidebar() {
    document.getElementById('sidebar').classList.remove('active');
    document.getElementById('sidebarOverlay').classList.remove('active');
    document.body.style.overflow = '';
}

function handleSearch(e) {
    var searchTerm = e.target.value.toLowerCase().trim();
    var treeItems = document.querySelectorAll('.tree-item');
    
    if (searchTerm === '') {
        treeItems.forEach(function(item) {
            item.style.display = '';
        });
        
        document.querySelectorAll('.tree-children.expanded').forEach(function(el) {
            el.classList.remove('expanded');
        });
        document.querySelectorAll('.tree-toggle.rotated').forEach(function(el) {
            el.classList.remove('rotated');
        });
        
        return;
    }
    
    treeItems.forEach(function(item) {
        var itemName = item.dataset.name || '';
        var isMatch = itemName.includes(searchTerm);
        
        if (isMatch) {
            item.style.display = '';
            
            var parent = item.parentElement;
            while (parent && parent.classList.contains('tree-children')) {
                parent.classList.add('expanded');
                var toggleIcon = parent.previousElementSibling ? parent.previousElementSibling.querySelector('.tree-toggle') : null;
                if (toggleIcon) {
                    toggleIcon.classList.add('rotated');
                }
                parent = parent.parentElement;
            }
        } else {
            item.style.display = 'none';
        }
    });
}
    </script>
</body>
</html>
